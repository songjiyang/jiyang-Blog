<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> vim</title><meta name="description" content="Vim的查找替换的匹配模式"><link rel="canonical" href="http://localhost:4000/posts/vim_pattern/"><link rel="alternate" type="application/rss+xml" title="JiYang's Blog" href="http://localhost:4000/feed.xml"><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|Roboto+Condensed:700&subset=latin' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/css/main.css"><meta property="og:url" content="http://localhost:4000/posts/vim_pattern/"><meta property="og:type" content="website"><meta property="og:title" content="vim模式"><meta property="og:description" content=""><meta property="og:site_name" content="JiYang's Blog"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="http://localhost:4000/posts/vim_pattern/"><meta name="twitter:title" content="vim模式"><meta name="twitter:description" content=""><meta property="og:image" content="http://localhost:4000http://pic.sjoe.top/blog/vim.png"><meta name="twitter:image" content="http://localhost:4000http://pic.sjoe.top/blog/vim.png"><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/">JiYang's Blog</a> <a href="/about/">About</a> <a href="/posts/">Archive</a>  <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><aside class="sidebar" role="note" style="background-image: url(http://pic.sjoe.top/blog/vim.png)"><div class="cover"><div class="cover-text"><div class="heading"> <a href="/posts/#vim">vim</a></div><p></div></div><div id="switcher"></div></aside><main class="content-wrapper blog-content"><article class="post"><h1 class="post-title">vim模式</h1><p class="post-meta"> <time datetime="2019-04-24">24-04-2019</time> &nbsp;/&nbsp; <span>宋天</span><div class="post-content"><p>Vim的查找替换的匹配模式<h5 id="查找">查找</h5><ul><li>:set ingorecase设置全局忽略大小写，影响配合和自动补全<li>\c忽略大小写，\C大小写敏感<li>:set smartcase在字符串全为小写时忽略大小写，字符串含有一个大写时大小写敏感<li>vim正则表达式更接近POSIX，而不是Perl<li>正则中中括号<code class="highlighter-rouge">[]</code>不需要转义（escape）；小括号<code class="highlighter-rouge">()</code>两个都需要转义；大括号<code class="highlighter-rouge">{}</code>只需要转义前面的就可以了,都转义也可以。<li>\v very magic 可以在正则中不需要转义特殊功能字符,和Perl规则一致<li>\V very nomagic 除了\有特殊含义之外，其他的字符都无特殊含义，如.*等<li>用小括号()引住的内容会被存起来，后面可以用/n引用到，n对应小括号的出现的位置，/0代表整个匹配的内容,使用%不让小括号去捕获内容,当括号中有括号时，按左括号出现的顺序排序<li><em>往下查找光标下的单词（整个单词），#往上查找，g</em>往下查找光标下的单词（不一定非得整个单词）,g#向上查找<li>escape(@u,’/'),使用escape函数将u寄存器中的内容的/前面增加\转义,更加通用的方式<code class="highlighter-rouge">escape(@u,getcmdtype().'\')</code></ul><table><thead><tr><th>常用字符含义(:h /character-classes)<th>作用<th>相反<th>作用<tbody><tr><td>\s<td>空白字符，空格和Tab<td>\S<td>非空白字符<tr><td>\d<td>数字<td>\D<td>非数字<tr><td>\x<td>十六进制 [0-9a-fA-F]<td>\X<td>非十六进制<tr><td>\o<td>八进制 [0-7]<td>\O<td>非八进制<tr><td>\w<td>数字，字母和下划线 [0-9a-zA-Z_]<td>\W<td>相反<tr><td>\h<td>字母和下划线[a-zA-z_]<td>\H<td>相反<tr><td>\a<td>字母 [a-zA-Z]<td>\A<td>相反<tr><td>\l<td>小写字母 [a-z]<td>\L<td>相反<tr><td>\u<td>大写字母 [A-Z]<td>\U<td>相反<tr><td>\e<td>Esc<td>-<td>-<tr><td>\t<td>Tab<td>-<td>-<tr><td>\r<td>CR<td>-<td>-<tr><td>\_<td>\_s 空格或者换行，s可以由上面的字母替换<td>-<td>-<tr><td>&lt;&gt;<td>单词的边界<td>-<td>-<tr><td>\zs \ze<td>匹配(match)的边界，表明了需要查找的部分,但任要符合模式(pattern)<td>-<td>-</table><table><thead><tr><th>命令<th>作用<tbody><tr><td>/<td>向后查找<tr><td>?<td>向前查找<tr><td>n<td>重复上一次查找<tr><td>N<td>反向上一次查找<tr><td>/CR<td>向下重复上一次查找<tr><td>?CR<td>向上重复上一次查找<tr><td>/{content}/e<td>查找指定内容，并将光标放到指定内容的后面<tr><td>//e<td>向下查找上一次内容并移动光标，可用于补救<tr><td>gn<td>—vim7.4 进入虚拟模式选中下个匹配，一般配合operator<tr><td>gN<td>—vim7.4 进入虚拟模式选中上个匹配，一般配合operator</table><ul><li>:set hls 设置高亮， :set nohls 关闭高亮， :nohls 这次关闭高亮<li>nnoremap <silent> <C-l> :<C-u>nohlsearch<CR><C-l> 设置C-L清除高亮,C-L通常用来清除屏幕信息</C-l></CR></C-u></C-l></silent><li>:set incsearch 设置在输入搜索关键字的同时会在文档中查找，并高亮给予反馈,对于需要查找整个单词的，这时不必手动打全，只用<code class="highlighter-rouge">C-rC-w</code>就可以将剩下的字符补全<li>可以先查找，捕获查找，在替换中引用，善于利用<up>和q/一步步完善正则表达式</up><li>%s///gn 统计次数，搜索域为空默认为使用当前的模式，g为每行的所有匹配，n为不实际执行替换，显示匹配的个数<li>:vimgrep //g % %代表当前文件 搜索域为空代表使用当前的模式，统计次数并显示当前是第几个，cnext和cprev可以在匹配中移动就好像n和N</ul><h5 id="替换">替换</h5><p><code class="highlighter-rouge">:[range]substitute/{pat-tern}/{string}/[flags]</code><table><thead><tr><th>替换域字符<th>作用<tbody><tr><td><code class="highlighter-rouge">\r</code><td>插入回车<tr><td><code class="highlighter-rouge">\t</code><td>插入tab<tr><td><code class="highlighter-rouge">\\</code><td>代表一个反斜杠<tr><td><code class="highlighter-rouge">\1</code><td>插入匹配域中第一个匹配，由括号括起来为一个匹配<tr><td><code class="highlighter-rouge">\2</code><td>插入第二个匹配，同理，直到<code class="highlighter-rouge">\9</code><tr><td><code class="highlighter-rouge">\0</code> <code class="highlighter-rouge">&amp;</code><td>插入整个匹配域<tr><td><code class="highlighter-rouge">~</code><td>使用上一个触发替换的字符串<tr><td><code class="highlighter-rouge">\={Vim Script}</code><td>使用vim脚本的结果<tr><td><code class="highlighter-rouge">C-r{register}</code><td>使用寄存器里面的内容</table><table><thead><tr><th>flag<th>作用<tbody><tr><td>g<td>匹配一行的所有出现情况，作为横向（%是ex命令range,作为纵向）<tr><td>c<td>在替换每个内容时确认，替换，跳过，退出，替换退出，替换剩下所有退出，翻页等功能</table><ul><li>替换时将搜索域留空默认使用当前匹配模式<li><code class="highlighter-rouge">:let @/=string</code> 相当于/string（除了在查找历史里面没用记录）<li><code class="highlighter-rouge">:let @a=string</code> 相当于将string放入寄存器a<li><code class="highlighter-rouge">:%s//\=@a/g</code> <code class="highlighter-rouge">\=</code>执行vim脚本，@从寄存器中取值，这三步相当于一次替换<li><code class="highlighter-rouge">g&amp;</code>相当于<code class="highlighter-rouge">:%s//~/&amp;</code> 对所有行以同样的标识（flag）重复上次的替换，&amp;上次的标识<li>可以对选中区域的内容实现替换<li>&amp;相当于:s ，执行上次替换，可以使用&amp;&amp;保持上次的flag<li>可以利用子匹配(submatch)重新排序<li>在vim脚本中必须使用submacht()方法引用子匹配<li><code class="highlighter-rouge">%s/\v(&lt;dog&gt;|&lt;man&gt;)/\={"dog":"man","man":"dog"}[submatch(1)]/g</code>将dog和man单词交换（希望多年后我还能看懂）<li><code class="highlighter-rouge">:vimgrep //g **/*</code> 查找当前目录及以下匹配模式的文件，<code class="highlighter-rouge">:copen</code>可以浏览匹配到的文件列表(quickfix)，并且可以通过回车和分裂窗口进行切换<li><code class="highlighter-rouge">:cfdo</code> 对quickfix中的文件进行统一修改，之前需先设置<code class="highlighter-rouge">:set hidden</code>不保存可以切换到其他文件<li><code class="highlighter-rouge">|</code> 在vim中代表将命令按顺序执行，在shell中代表管道符</ul><h5 id="全局命令">全局命令</h5><p><code class="highlighter-rouge">:[range] global[!] /{pattern}/ [cmd]</code><ul><li>默认范围（range）是%,这一点与通常的命令不同，通常命令范围默认都是针对行的<li>模式（pattern）是查找和替换中的一致，可以留空<li>命令（cmd）可以是global的命令之外的任何命令,默认是print<li><code class="highlighter-rouge">global!</code>和<code class="highlighter-rouge">vglobal</code>将作用于不匹配的模式<li><code class="highlighter-rouge">g/re/p</code>是这个命令的缩写模式，也是grep命令的来源<li><code class="highlighter-rouge">v/re/d</code> 仅留下匹配的行，vglobal<li><code class="highlighter-rouge">g/re/y A</code> 将内容追加到寄存器a中，可以存多行内容存到寄存器中，而小写a是覆盖，多行内容只会存最后一行，可以在执行之前<code class="highlighter-rouge">qaq</code>清空寄存器a的内容<li><code class="highlighter-rouge">g/re/t$</code> 将匹配内容复制到行尾<li><code class="highlighter-rouge">:sort</code> 对指定范围内的行首按照字母表排序<li><code class="highlighter-rouge">:g/{/ .+1,/}/-1 sort</code> 这个命令里面的内容都学过，功能是?<li><code class="highlighter-rouge">g/{start}/ .,{finish}</code> [cmd] 通用模式</ul><div class="post-links"> <a class="link-to-post" href="/posts/vim_tool/"> <span class="link-to-post__next">&#10535; &nbsp;Next post</span> <span class="link-to-post__title">vim工具</span> </a> <a class="link-to-post" href="/posts/vim_file/"> <span class="link-to-post__prev">&#10535; &nbsp;Previous post</span> <span class="link-to-post__title">vim文件</span> </a></div></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> JiYang's Blog</footer><script src="/assets/js/scripts.js"></script>
